From 1797880043d6153a03ca06fd9a6768b1f6dfad7e Mon Sep 17 00:00:00 2001
From: Thiago Macieira <thiago.macieira@intel.com>
Date: Mon, 6 Oct 2025 16:44:36 +0000
Subject: [PATCH 330/553] Revert "QAbstractSocket/QHostAddress: ensure
 definition of static constexprs"
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This reverts commit b42bcc84dc3c0f344b8c4591fce86d5ef4266eba.

Reason for revert: This doesn't need to be picked to 6.10. The actual
fix is in another commit.

Change-Id: I5a96e2613eda1d03d3124fefb8cefe5d542b8e5e
Reviewed-by: MÃ¥rten Nordheim <marten.nordheim@qt.io>
---
 src/network/socket/qabstractsocket.h | 22 +++++++---------------
 1 file changed, 7 insertions(+), 15 deletions(-)

diff --git a/src/network/socket/qabstractsocket.h b/src/network/socket/qabstractsocket.h
index 8d2e8a299cc..f3db8b0e722 100644
--- a/src/network/socket/qabstractsocket.h
+++ b/src/network/socket/qabstractsocket.h
@@ -23,22 +23,7 @@ class QNetworkProxy;
 class QAbstractSocketPrivate;
 class QAuthenticator;
 
-namespace QtPrivate {
-struct QAbstractSocketConstants
-{
-#if QT_VERSION >= QT_VERSION_CHECK(7, 0, 0)
-    // compatibility with Qt 4 to 6
-    using NetworkLayerProtocol = QHostAddress::NetworkLayerProtocol;
-    static constexpr auto IPv4Protocol = QHostAddress::IPv4Protocol;
-    static constexpr auto IPv6Protocol = QHostAddress::IPv6Protocol;
-    static constexpr auto AnyIPProtocol = QHostAddress::AnyIPProtocol;
-    static constexpr auto UnknownNetworkLayerProtocol = QHostAddress::UnknownNetworkLayerProtocol;
-#endif
-};
-}
-
 class Q_NETWORK_EXPORT QAbstractSocket : public QIODevice
-        QT7_ONLY(, public QtPrivate::QAbstractSocketConstants)
 {
     Q_OBJECT
     Q_MOC_INCLUDE(<QtNetwork/qauthenticator.h>)
@@ -60,6 +45,13 @@ public:
         UnknownNetworkLayerProtocol = -1
     };
     Q_ENUM(NetworkLayerProtocol)
+#else
+    // compatibility with Qt 4 to 6
+    using NetworkLayerProtocol = QHostAddress::NetworkLayerProtocol;
+    static constexpr auto IPv4Protocol = QHostAddress::IPv4Protocol;
+    static constexpr auto IPv6Protocol = QHostAddress::IPv6Protocol;
+    static constexpr auto AnyIPProtocol = QHostAddress::AnyIPProtocol;
+    static constexpr auto UnknownNetworkLayerProtocol = QHostAddress::UnknownNetworkLayerProtocol;
 #endif
 
     enum SocketError {
-- 
2.51.2

