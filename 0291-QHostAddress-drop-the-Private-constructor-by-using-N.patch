From 93ccae8f21257de25e2187d329dab72463205665 Mon Sep 17 00:00:00 2001
From: Thiago Macieira <thiago.macieira@intel.com>
Date: Thu, 2 Oct 2025 20:46:30 -0700
Subject: [PATCH 291/553] QHostAddress: drop the Private constructor by using
 NSDMI
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Change-Id: Idf70d329977e17b5b936fffd1debc21f1b86c43a
Reviewed-by: MÃ¥rten Nordheim <marten.nordheim@qt.io>
(cherry picked from commit 04ee4e627bf7002ece660f70eedf29b9da4006c6)
Reviewed-by: Qt Cherry-pick Bot <cherrypick_bot@qt-project.org>
---
 src/network/kernel/qhostaddress.cpp | 6 ------
 src/network/kernel/qhostaddress_p.h | 8 +++-----
 2 files changed, 3 insertions(+), 11 deletions(-)

diff --git a/src/network/kernel/qhostaddress.cpp b/src/network/kernel/qhostaddress.cpp
index 24b7e4ccebb..1bd3345a336 100644
--- a/src/network/kernel/qhostaddress.cpp
+++ b/src/network/kernel/qhostaddress.cpp
@@ -36,12 +36,6 @@ const QAbstractSocket::NetworkLayerProtocol QHostAddress::AnyIPProtocol;
 const QAbstractSocket::NetworkLayerProtocol QHostAddress::UnknownNetworkLayerProtocol;
 #endif
 
-QHostAddressPrivate::QHostAddressPrivate()
-    : a(0), protocol(QHostAddress::UnknownNetworkLayerProtocol)
-{
-    memset(&a6, 0, sizeof(a6));
-}
-
 QT_DEFINE_QESDP_SPECIALIZATION_DTOR(QHostAddressPrivate)
 
 void QHostAddressPrivate::setAddress(quint32 a_)
diff --git a/src/network/kernel/qhostaddress_p.h b/src/network/kernel/qhostaddress_p.h
index b147630c4e9..6cc28cd5a9b 100644
--- a/src/network/kernel/qhostaddress_p.h
+++ b/src/network/kernel/qhostaddress_p.h
@@ -69,8 +69,6 @@ public:
 class QHostAddressPrivate : public QSharedData
 {
 public:
-    QHostAddressPrivate();
-
     void setAddress(quint32 a_ = 0);
     void setAddress(const quint8 *a_);
     void setAddress(const Q_IPV6ADDR &a_);
@@ -81,12 +79,12 @@ public:
     QString scopeId;
 
     union {
-        Q_IPV6ADDR a6; // IPv6 address
+        Q_IPV6ADDR a6 = {};     // IPv6 address
         struct { quint64 c[2]; } a6_64;
         struct { quint32 c[4]; } a6_32;
     };
-    quint32 a;    // IPv4 address
-    qint8 protocol;
+    quint32 a = 0;      // IPv4 address
+    qint8 protocol = QHostAddress::UnknownNetworkLayerProtocol;
 
     AddressClassification classify() const;
     static AddressClassification classify(const QHostAddress &address)
-- 
2.51.2

