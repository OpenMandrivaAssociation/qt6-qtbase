From fc53758aba4f2e869dcd79be54d80785da4693af Mon Sep 17 00:00:00 2001
From: Assam Boudjelthia <assam.boudjelthia@qt.io>
Date: Mon, 1 Sep 2025 03:42:26 +0300
Subject: [PATCH 034/553] Android: warn instead of assert on invalid winId on
 windowFocusChanged
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Pick-to: 6.9
Change-Id: I2cb0431dccc1fd87a4d363b4bcc9a18443abbaaf
Reviewed-by: Tor Arne Vestb√∏ <tor.arne.vestbo@qt.io>
(cherry picked from commit cea76e7c5fe963b7d0867bff47f140bfb2f55744)
Reviewed-by: Qt Cherry-pick Bot <cherrypick_bot@qt-project.org>
---
 src/plugins/platforms/android/qandroidplatformwindow.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/plugins/platforms/android/qandroidplatformwindow.cpp b/src/plugins/platforms/android/qandroidplatformwindow.cpp
index da875a7cd98..ccd40f5f5d4 100644
--- a/src/plugins/platforms/android/qandroidplatformwindow.cpp
+++ b/src/plugins/platforms/android/qandroidplatformwindow.cpp
@@ -381,7 +381,12 @@ void QAndroidPlatformWindow::windowFocusChanged(JNIEnv *env, jobject object,
     Q_UNUSED(env)
     Q_UNUSED(object)
     QWindow* window = QtAndroid::windowFromId(windowId);
-    Q_ASSERT_X(window, "QAndroidPlatformWindow", "windowFocusChanged event window should exist");
+    if (!window) {
+        qCWarning(lcQpaWindow,
+            "windowFocusChanged event received for non-existing window %d", windowId);
+        return;
+    }
+
     if (focus) {
         QWindowSystemInterface::handleFocusWindowChanged(window);
     } else if (!focus && window == qGuiApp->focusWindow()) {
-- 
2.51.2

